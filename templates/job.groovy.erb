import java.lang.System;
import jenkins.*
import jenkins.model.*
import hudson.*
import hudson.model.*

////////////////////////////////////////////////////////////////////////////////
// defines which puppet provides
////////////////////////////////////////////////////////////////////////////////
def jobName = "<%= @job_name %>"
def jobXml = '''<%= @job_xml %>'''
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Header for log
////////////////////////////////////////////////////////////////////////////////
println("########## BEGIN: job config: ${jobName} ##########")
////////////////////////////////////////////////////////////////////////////////

class JobConfig {

  def jenkinsInstance = jenkins.model.Jenkins.getInstance()
  def updateCenter = jenkinsInstance.getUpdateCenter()

  public JobConfig (jobName, jobXml) {
    jenkinsInstance.createProjectFromXML(jobName, new ByteArrayInputStream(jobXml.getBytes()))
  }
}

new JobConfig(jobName, jobXml)
////////////////////////////////////////////////////////////////////////////////
// Footer for log
////////////////////////////////////////////////////////////////////////////////
println("########## END: job config ##########")
////////////////////////////////////////////////////////////////////////////////
